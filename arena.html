<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Comparison Tool</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons (via CDN) -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        
        // Icon components using Lucide
        const Upload = () => <i data-lucide="upload"></i>;
        const PlayCircle = () => <i data-lucide="play-circle"></i>;
        const Download = () => <i data-lucide="download"></i>;
        const AlertCircle = () => <i data-lucide="alert-circle"></i>;
        const CheckCircle = () => <i data-lucide="check-circle"></i>;
        const Clock = () => <i data-lucide="clock"></i>;
        const DollarSign = () => <i data-lucide="dollar-sign"></i>;
        const Target = () => <i data-lucide="target"></i>;
        const Info = () => <i data-lucide="info"></i>;
        const Plus = () => <i data-lucide="plus"></i>;
        const X = () => <i data-lucide="x"></i>;
        const Edit2 = () => <i data-lucide="edit-2"></i>;
        const Save = () => <i data-lucide="save"></i>;

        const LLMComparisonTool = () => {
            const [pdfFile, setPdfFile] = useState(null);
            const [pdfBase64, setPdfBase64] = useState(null);
            const [testPrompt, setTestPrompt] = useState('Extract all key information from this document including names, dates, amounts, and main topics.');
            const [results, setResults] = useState([]);
            const [isRunning, setIsRunning] = useState(false);
            const [debugInfo, setDebugInfo] = useState('');
            const [anthropicApiKey, setAnthropicApiKey] = useState('');
            const [openaiApiKey, setOpenaiApiKey] = useState('');
            
            // Production API endpoint - hardcoded
            const apiEndpoint = 'https://jitterbitllmcomparison-p0qq.onrender.com';
            
            const [selectedModels, setSelectedModels] = useState({
                'claude-sonnet-4-20250514': true,
            });
            const [showAddModel, setShowAddModel] = useState(false);
            const [newModel, setNewModel] = useState({
                id: '',
                name: '',
                provider: '',
                api_endpoint: '',
                api_type: 'openai',
                api_key: '',
                input_cost_per_1m: 0,
                output_cost_per_1m: 0
            });
            const [customModels, setCustomModels] = useState({});

            // Available models
            const availableModels = {
                'claude-sonnet-4-20250514': {
                    name: 'Claude Sonnet 4',
                    provider: 'Anthropic',
                    color: '#6366f1'
                },
                'claude-haiku-4-5-20251001': {
                    name: 'Claude Haiku 4.5',
                    provider: 'Anthropic',
                    color: '#8b5cf6'
                },
                'claude-opus-4-20250514': {
                    name: 'Claude Opus 4',
                    provider: 'Anthropic',
                    color: '#ec4899'
                },
                'gpt-4o': {
                    name: 'GPT-4o',
                    provider: 'OpenAI',
                    color: '#10a37f'
                },
                'gpt-4-turbo': {
                    name: 'GPT-4 Turbo',
                    provider: 'OpenAI',
                    color: '#19c37d'
                },
                'gpt-3.5-turbo': {
                    name: 'GPT-3.5 Turbo',
                    provider: 'OpenAI',
                    color: '#26d07c'
                }
            };

            React.useEffect(() => {
                lucide.createIcons();
            }, [results, debugInfo]);

            const handleFileUpload = async (e) => {
                const file = e.target.files[0];
                if (file && file.type === 'application/pdf') {
                    setPdfFile(file);
                    setDebugInfo(`File uploaded: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`);
                    
                    try {
                        const base64Data = await new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onload = () => resolve(reader.result.split(',')[1]);
                            reader.onerror = reject;
                            reader.readAsDataURL(file);
                        });
                        
                        setPdfBase64(base64Data);
                        setDebugInfo(prev => prev + '\nBase64 conversion successful');
                    } catch (error) {
                        setDebugInfo(prev => prev + `\nError converting to base64: ${error.message}`);
                    }
                } else {
                    alert('Please upload a PDF file');
                }
            };

            const toggleModel = (modelId) => {
                setSelectedModels(prev => ({
                    ...prev,
                    [modelId]: !prev[modelId]
                }));
            };

            const addCustomModel = () => {
                if (!newModel.id || !newModel.name || !newModel.api_endpoint) {
                    alert('Please fill in Model ID, Name, and API Endpoint');
                    return;
                }

                const modelConfig = {
                    ...newModel,
                    color: '#' + Math.floor(Math.random()*16777215).toString(16)
                };

                setCustomModels(prev => ({
                    ...prev,
                    [newModel.id]: modelConfig
                }));

                setSelectedModels(prev => ({
                    ...prev,
                    [newModel.id]: true
                }));

                setNewModel({
                    id: '',
                    name: '',
                    provider: '',
                    api_endpoint: '',
                    api_type: 'openai',
                    api_key: '',
                    input_cost_per_1m: 0,
                    output_cost_per_1m: 0
                });

                setShowAddModel(false);
                alert('Custom model added! It will appear in the "Custom Models" section.');
            };

            const runComparison = async () => {
                if (!pdfFile) {
                    alert('Please upload a PDF first');
                    return;
                }

                const modelsToTest = Object.keys(selectedModels).filter(key => selectedModels[key]);
                
                if (modelsToTest.length === 0) {
                    alert('Please select at least one model to test');
                    return;
                }

                // Check if API keys are needed
                const needsAnthropicKey = modelsToTest.some(m => m.startsWith('claude-'));
                const needsOpenAIKey = modelsToTest.some(m => m.startsWith('gpt-'));

                if (needsAnthropicKey && !anthropicApiKey) {
                    alert('Please enter your Anthropic API key for Claude models');
                    return;
                }

                if (needsOpenAIKey && !openaiApiKey) {
                    alert('Please enter your OpenAI API key for GPT models');
                    return;
                }

                setIsRunning(true);
                setResults([]);
                setDebugInfo('Starting comparison via API...\n');

                try {
                    // Build custom models with API keys
                    const customModels = [];
                    
                    // Add Anthropic models with API keys
                    if (needsAnthropicKey) {
                        modelsToTest.forEach(modelId => {
                            if (modelId.startsWith('claude-')) {
                                const model = availableModels[modelId];
                                customModels.push({
                                    id: modelId,
                                    name: model.name,
                                    provider: model.provider,
                                    api_endpoint: "https://api.anthropic.com/v1/messages",
                                    api_type: "anthropic",
                                    api_key: anthropicApiKey,
                                    input_cost_per_1m: 3.0,
                                    output_cost_per_1m: 15.0,
                                    max_tokens: 4096,
                                    auth_header: "x-api-key",
                                    auth_prefix: "",
                                    custom_headers: {
                                        "anthropic-version": "2023-06-01"
                                    }
                                });
                            }
                        });
                    }

                    if (needsOpenAIKey) {
                        modelsToTest.forEach(modelId => {
                            if (modelId.startsWith('gpt-')) {
                                const model = availableModels[modelId];
                                const costs = {
                                    'gpt-4o': { input: 2.50, output: 10.00 },
                                    'gpt-4-turbo': { input: 10.00, output: 30.00 },
                                    'gpt-3.5-turbo': { input: 0.50, output: 1.50 }
                                };
                                const cost = costs[modelId] || { input: 2.50, output: 10.00 };
                                
                                customModels.push({
                                    id: modelId,
                                    name: model.name,
                                    provider: model.provider,
                                    api_endpoint: "https://api.openai.com/v1/chat/completions",
                                    api_type: "openai",
                                    api_key: openaiApiKey,
                                    input_cost_per_1m: cost.input,
                                    output_cost_per_1m: cost.output,
                                    max_tokens: 4096,
                                    auth_header: "Authorization",
                                    auth_prefix: "Bearer "
                                });
                            }
                        });
                    }

                    // Add user's custom models with their API keys
                    modelsToTest.forEach(modelId => {
                        if (customModels[modelId]) {
                            customModels.push(customModels[modelId]);
                        }
                    });

                    // Create FormData
                    const formData = new FormData();
                    formData.append('file', pdfFile);
                    formData.append('model_ids', modelsToTest.join(','));
                    formData.append('prompt', testPrompt);
                    
                    if (customModels.length > 0) {
                        formData.append('custom_models_json', JSON.stringify(customModels));
                    }

                    setDebugInfo(prev => prev + `\nSending request to ${apiEndpoint}/api/compare`);
                    setDebugInfo(prev => prev + `\nModels: ${modelsToTest.join(', ')}`);
                    setDebugInfo(prev => prev + `\nUsing ${customModels.length} custom model configs with API keys`);

                    const response = await fetch(`${apiEndpoint}/api/compare`, {
                        method: 'POST',
                        body: formData
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API Error ${response.status}: ${JSON.stringify(errorData)}`);
                    }

                    const data = await response.json();
                    setDebugInfo(prev => prev + '\n✓ Comparison completed successfully!');
                    setResults(data.results || []);

                } catch (error) {
                    setDebugInfo(prev => prev + `\n✗ Error: ${error.message}`);
                    alert(`Error: ${error.message}`);
                } finally {
                    setIsRunning(false);
                }
            };

            const exportResults = () => {
                const csv = [
                    ['Model', 'Provider', 'Response Time (s)', 'Cost ($)', 'Accuracy (%)', 'Status'],
                    ...results.map(r => [
                        r.model_name,
                        r.provider,
                        r.response_time,
                        r.cost || 'N/A',
                        r.accuracy || 'N/A',
                        r.success ? 'Success' : 'Failed'
                    ])
                ].map(row => row.join(',')).join('\n');

                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'llm-comparison-results.csv';
                a.click();
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 p-6">
                    <div className="max-w-7xl mx-auto">
                        {/* Header with Jitterbit Branding */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-8">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-4">
                                    <div className="w-16 h-16 bg-gradient-to-br from-purple-600 to-blue-600 rounded-lg flex items-center justify-center">
                                        <span className="text-white font-bold text-2xl">J</span>
                                    </div>
                                    <div>
                                        <h1 className="text-3xl font-bold text-slate-900">Jitterbit LLM Comparison Tool</h1>
                                        <p className="text-slate-600 mt-1">Test PDF parsing across multiple AI models - Compare speed, accuracy, and cost</p>
                                    </div>
                                </div>
                                <div className="text-right flex flex-col items-end gap-3">
                                    <div>
                                        <p className="text-sm text-slate-500">Powered by</p>
                                        <p className="text-lg font-semibold text-purple-600">Jitterbit</p>
                                    </div>
                                    <a
                                        href="https://www.jitterbit.com/contact-us/"
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className="inline-flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-semibold px-4 py-2 rounded-lg transition-colors"
                                    >
                                        Contact Us
                                    </a>
                                </div>
                            </div>
                        </div>

                        {/* API Keys Configuration */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <h2 className="text-xl font-semibold mb-4">API Keys Configuration</h2>
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-2">
                                        Anthropic API Key (for Claude models)
                                    </label>
                                    <input
                                        type="password"
                                        value={anthropicApiKey}
                                        onChange={(e) => setAnthropicApiKey(e.target.value)}
                                        className="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        placeholder="sk-ant-api03-..."
                                    />
                                    <p className="text-sm text-slate-500 mt-1">
                                        Get your key from <a href="https://console.anthropic.com/" target="_blank" className="text-purple-600 hover:underline">console.anthropic.com</a>
                                    </p>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-slate-700 mb-2">
                                        OpenAI API Key (for GPT models) - Optional
                                    </label>
                                    <input
                                        type="password"
                                        value={openaiApiKey}
                                        onChange={(e) => setOpenaiApiKey(e.target.value)}
                                        className="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        placeholder="sk-..."
                                    />
                                    <p className="text-sm text-slate-500 mt-1">
                                        Get your key from <a href="https://platform.openai.com/" target="_blank" className="text-purple-600 hover:underline">platform.openai.com</a>
                                    </p>
                                </div>
                            </div>
                        </div>

                     
                        {/* Terms */}
                        <div className="bg-slate-50 border border-slate-200 rounded-lg p-5 mb-6">
                            <h3 className="font-semibold text-slate-900 mb-2">Terms of Service</h3>
                            <div className="text-sm text-slate-700">
                                <p className="mb-2">By using this tool, you agree to:</p>
                                <ul className="list-disc list-inside ml-2 space-y-1">
                                    <li>Not upload confidential or sensitive data</li>
                                    <li>Comply with all applicable laws</li>
                                    <li>Accept third-party LLM provider terms</li>
                                </ul>
                                <p className="mt-3 text-xs text-slate-500">Questions? <a href="mailto:privacy@jitterbit.com" className="text-purple-600 hover:underline">privacy@jitterbit.com</a></p>
                            </div>
                        </div>

                        {/* Upload Section */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <h2 className="text-xl font-semibold mb-4 flex items-center gap-2">
                                <Upload />
                                Upload PDF Document
                            </h2>
                            
                            <div className="border-2 border-dashed border-slate-300 rounded-lg p-8 text-center mb-4">
                                <input
                                    type="file"
                                    accept="application/pdf"
                                    onChange={handleFileUpload}
                                    className="hidden"
                                    id="pdf-upload"
                                />
                                <label htmlFor="pdf-upload" className="cursor-pointer">
                                    <div className="w-12 h-12 mx-auto mb-3 text-slate-400">
                                        <Upload />
                                    </div>
                                    <p className="text-slate-600 mb-1">
                                        {pdfFile ? pdfFile.name : 'Click to upload PDF'}
                                    </p>
                                    <p className="text-sm text-slate-400">PDF files up to 10MB</p>
                                </label>
                            </div>

                            <div className="mb-4">
                                <label className="block text-sm font-medium text-slate-700 mb-2">
                                    Test Prompt
                                </label>
                                <textarea
                                    value={testPrompt}
                                    onChange={(e) => setTestPrompt(e.target.value)}
                                    className="w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    rows="3"
                                />
                            </div>
                        </div>

                        {/* Model Selection */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-xl font-semibold">Select Models to Test</h2>
                                <button
                                    onClick={() => setShowAddModel(!showAddModel)}
                                    className="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg inline-flex items-center gap-2 text-sm"
                                >
                                    <Plus />
                                    Add Custom Model
                                </button>
                            </div>

                            {/* Add Model Dialog */}
                            {showAddModel && (
                                <div className="mb-6 p-4 bg-purple-50 rounded-lg border-2 border-purple-200">
                                    <h3 className="font-semibold mb-3 text-lg text-purple-900">Add Custom Model</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Model ID *</label>
                                            <input
                                                type="text"
                                                value={newModel.id}
                                                onChange={(e) => setNewModel({...newModel, id: e.target.value})}
                                                placeholder="e.g., mixtral-8x7b"
                                                className="w-full px-3 py-2 border rounded-lg"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Display Name *</label>
                                            <input
                                                type="text"
                                                value={newModel.name}
                                                onChange={(e) => setNewModel({...newModel, name: e.target.value})}
                                                placeholder="e.g., Mixtral 8x7B"
                                                className="w-full px-3 py-2 border rounded-lg"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Provider</label>
                                            <input
                                                type="text"
                                                value={newModel.provider}
                                                onChange={(e) => setNewModel({...newModel, provider: e.target.value})}
                                                placeholder="e.g., Together AI"
                                                className="w-full px-3 py-2 border rounded-lg"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">API Endpoint *</label>
                                            <input
                                                type="text"
                                                value={newModel.api_endpoint}
                                                onChange={(e) => setNewModel({...newModel, api_endpoint: e.target.value})}
                                                placeholder="https://api.example.com/v1/chat"
                                                className="w-full px-3 py-2 border rounded-lg"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">API Type</label>
                                            <select
                                                value={newModel.api_type}
                                                onChange={(e) => setNewModel({...newModel, api_type: e.target.value})}
                                                className="w-full px-3 py-2 border rounded-lg"
                                            >
                                                <option value="openai">OpenAI Format</option>
                                                <option value="anthropic">Anthropic Format</option>
                                                <option value="custom">Custom Format</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">API Key</label>
                                            <input
                                                type="password"
                                                value={newModel.api_key}
                                                onChange={(e) => setNewModel({...newModel, api_key: e.target.value})}
                                                placeholder="Your API key"
                                                className="w-full px-3 py-2 border rounded-lg"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Input Cost ($/1M tokens)</label>
                                            <input
                                                type="number"
                                                step="0.01"
                                                value={newModel.input_cost_per_1m}
                                                onChange={(e) => setNewModel({...newModel, input_cost_per_1m: parseFloat(e.target.value) || 0})}
                                                className="w-full px-3 py-2 border rounded-lg"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Output Cost ($/1M tokens)</label>
                                            <input
                                                type="number"
                                                step="0.01"
                                                value={newModel.output_cost_per_1m}
                                                onChange={(e) => setNewModel({...newModel, output_cost_per_1m: parseFloat(e.target.value) || 0})}
                                                className="w-full px-3 py-2 border rounded-lg"
                                            />
                                        </div>
                                    </div>
                                    <div className="flex gap-2 mt-4">
                                        <button
                                            onClick={addCustomModel}
                                            className="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg"
                                        >
                                            Add Model
                                        </button>
                                        <button
                                            onClick={() => setShowAddModel(false)}
                                            className="bg-slate-500 hover:bg-slate-600 text-white px-4 py-2 rounded-lg"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            )}
                            
                            {/* Anthropic Models */}
                            <div className="mb-6">
                                <h3 className="text-lg font-semibold text-slate-700 mb-3 flex items-center gap-2">
                                    <span className="w-3 h-3 rounded-full bg-blue-500"></span>
                                    Anthropic (Claude)
                                </h3>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    {Object.entries(availableModels)
                                        .filter(([id]) => id.startsWith('claude-'))
                                        .map(([modelId, model]) => (
                                            <div
                                                key={modelId}
                                                onClick={() => toggleModel(modelId)}
                                                className={`border-2 rounded-lg p-4 cursor-pointer transition-all ${
                                                    selectedModels[modelId]
                                                        ? 'border-blue-500 bg-blue-50'
                                                        : 'border-slate-200 hover:border-slate-300'
                                                }`}
                                            >
                                                <div className="flex items-start justify-between">
                                                    <div>
                                                        <h3 className="font-semibold text-slate-900">{model.name}</h3>
                                                        <p className="text-sm text-slate-600">{model.provider}</p>
                                                    </div>
                                                    <input
                                                        type="checkbox"
                                                        checked={selectedModels[modelId] || false}
                                                        onChange={() => {}}
                                                        className="mt-1"
                                                    />
                                                </div>
                                            </div>
                                        ))}
                                </div>
                            </div>

                            {/* OpenAI Models */}
                            <div>
                                <h3 className="text-lg font-semibold text-slate-700 mb-3 flex items-center gap-2">
                                    <span className="w-3 h-3 rounded-full bg-green-500"></span>
                                    OpenAI (GPT)
                                </h3>
                                <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-3">
                                    <p className="text-sm text-yellow-800">
                                        <strong>Note:</strong> OpenAI models don't support direct PDF input. The tool will extract text from the PDF first.
                                        For best results with complex PDFs (tables, images), use Claude models.
                                    </p>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    {Object.entries(availableModels)
                                        .filter(([id]) => id.startsWith('gpt-'))
                                        .map(([modelId, model]) => (
                                            <div
                                                key={modelId}
                                                onClick={() => toggleModel(modelId)}
                                                className={`border-2 rounded-lg p-4 cursor-pointer transition-all ${
                                                    selectedModels[modelId]
                                                        ? 'border-green-500 bg-green-50'
                                                        : 'border-slate-200 hover:border-slate-300'
                                                }`}
                                            >
                                                <div className="flex items-start justify-between">
                                                    <div>
                                                        <h3 className="font-semibold text-slate-900">{model.name}</h3>
                                                        <p className="text-sm text-slate-600">{model.provider}</p>
                                                    </div>
                                                    <input
                                                        type="checkbox"
                                                        checked={selectedModels[modelId] || false}
                                                        onChange={() => {}}
                                                        className="mt-1"
                                                    />
                                                </div>
                                            </div>
                                        ))}
                                </div>
                            </div>

                            {/* Custom Models */}
                            {Object.keys(customModels).length > 0 && (
                                <div className="mt-6">
                                    <h3 className="text-lg font-semibold text-slate-700 mb-3 flex items-center gap-2">
                                        <span className="w-3 h-3 rounded-full bg-purple-500"></span>
                                        Custom Models
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        {Object.entries(customModels).map(([modelId, model]) => (
                                            <div
                                                key={modelId}
                                                onClick={() => toggleModel(modelId)}
                                                className={`border-2 rounded-lg p-4 cursor-pointer transition-all ${
                                                    selectedModels[modelId]
                                                        ? 'border-purple-500 bg-purple-50'
                                                        : 'border-slate-200 hover:border-slate-300'
                                                }`}
                                            >
                                                <div className="flex items-start justify-between">
                                                    <div className="flex-1">
                                                        <h3 className="font-semibold text-slate-900">{model.name}</h3>
                                                        <p className="text-sm text-slate-600">{model.provider || 'Custom'}</p>
                                                        <p className="text-xs text-slate-400 mt-1 truncate">{modelId}</p>
                                                    </div>
                                                    <input
                                                        type="checkbox"
                                                        checked={selectedModels[modelId] || false}
                                                        onChange={() => {}}
                                                        className="mt-1"
                                                    />
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Run Button */}
                        <div className="text-center mb-6">
                            <button
                                onClick={runComparison}
                                disabled={isRunning || !pdfFile}
                                className="bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white px-8 py-3 rounded-lg font-semibold inline-flex items-center gap-2"
                            >
                                <PlayCircle />
                                {isRunning ? 'Running Tests...' : 'Run Comparison'}
                            </button>
                        </div>

                        {/* Debug Info */}
                        {debugInfo && (
                            <div className="bg-slate-900 rounded-lg shadow-lg p-4 mb-6">
                                <div className="flex items-center gap-2 mb-2">
                                    <Info />
                                    <h3 className="text-white font-semibold">Debug Log</h3>
                                </div>
                                <pre className="text-sm text-slate-300 whitespace-pre-wrap font-mono">
                                    {debugInfo}
                                </pre>
                            </div>
                        )}

                        {/* Results */}
                        {results.length > 0 && (
                            <>
                                {/* Summary Cards */}
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                    {(() => {
                                        const successfulResults = results.filter(r => r.success);
                                        if (successfulResults.length === 0) return null;
                                        
                                        const bestSpeed = successfulResults.reduce((best, curr) => 
                                            curr.response_time < best.response_time ? curr : best
                                        );
                                        const bestCost = successfulResults.reduce((best, curr) => 
                                            (curr.cost || Infinity) < (best.cost || Infinity) ? curr : best
                                        );
                                        const bestAccuracy = successfulResults.reduce((best, curr) => 
                                            (curr.accuracy || 0) > (best.accuracy || 0) ? curr : best
                                        );
                                        
                                        return (
                                            <>
                                                <div className="bg-white rounded-lg shadow-lg p-4">
                                                    <div className="flex items-center gap-2 mb-2">
                                                        <Clock />
                                                        <h3 className="font-semibold text-slate-700">Best Speed</h3>
                                                    </div>
                                                    <p className="text-2xl font-bold text-green-600">{bestSpeed.model_name}</p>
                                                    <p className="text-sm text-slate-600 mt-1">{bestSpeed.response_time}s</p>
                                                </div>
                                                <div className="bg-white rounded-lg shadow-lg p-4">
                                                    <div className="flex items-center gap-2 mb-2">
                                                        <DollarSign />
                                                        <h3 className="font-semibold text-slate-700">Best Cost</h3>
                                                    </div>
                                                    <p className="text-2xl font-bold text-blue-600">{bestCost.model_name}</p>
                                                    <p className="text-sm text-slate-600 mt-1">${bestCost.cost}</p>
                                                </div>
                                                <div className="bg-white rounded-lg shadow-lg p-4">
                                                    <div className="flex items-center gap-2 mb-2">
                                                        <Target />
                                                        <h3 className="font-semibold text-slate-700">Best Accuracy</h3>
                                                    </div>
                                                    <p className="text-2xl font-bold text-purple-600">{bestAccuracy.model_name}</p>
                                                    <p className="text-sm text-slate-600 mt-1">{bestAccuracy.accuracy}%</p>
                                                </div>
                                            </>
                                        );
                                    })()}
                                </div>

                                {/* Detailed Results */}
                                <div className="bg-white rounded-lg shadow-lg overflow-hidden mb-6">
                                    <div className="p-4 bg-slate-50 border-b flex justify-between items-center">
                                        <h2 className="text-xl font-semibold">Comparison Results</h2>
                                        <button
                                            onClick={exportResults}
                                            className="bg-slate-700 hover:bg-slate-800 text-white px-4 py-2 rounded-lg inline-flex items-center gap-2 text-sm"
                                        >
                                            <Download />
                                            Export CSV
                                        </button>
                                    </div>
                                    
                                    <div className="p-6">
                                        {/* Grid layout for side-by-side comparison */}
                                        <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                                            {results.map((result, idx) => (
                                                <div key={idx} className="border-2 rounded-lg overflow-hidden flex flex-col h-full">
                                                    {/* Header */}
                                                    <div className="bg-gradient-to-r from-slate-50 to-slate-100 p-4 border-b">
                                                        <div className="flex items-start justify-between mb-2">
                                                            <div className="flex-1">
                                                                <h3 className="text-lg font-bold text-slate-900">{result.model_name}</h3>
                                                                <p className="text-sm text-slate-600">{result.provider}</p>
                                                            </div>
                                                            {result.success ? (
                                                                <span className="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1 whitespace-nowrap">
                                                                    <CheckCircle className="w-3 h-3" /> Success
                                                                </span>
                                                            ) : (
                                                                <span className="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1 whitespace-nowrap">
                                                                    <AlertCircle className="w-3 h-3" /> Failed
                                                                </span>
                                                            )}
                                                        </div>
                                                    </div>

                                                    {/* Metrics */}
                                                    {result.success && (
                                                        <>
                                                            <div className="bg-white p-3 border-b">
                                                                <div className="grid grid-cols-2 gap-2">
                                                                    <div className="text-center p-2 bg-blue-50 rounded">
                                                                        <div className="flex items-center justify-center gap-1 mb-1">
                                                                            <Clock className="w-3 h-3 text-blue-600" />
                                                                            <p className="text-xs font-medium text-blue-900">Speed</p>
                                                                        </div>
                                                                        <p className="text-lg font-bold text-blue-600">{result.response_time}s</p>
                                                                    </div>
                                                                    <div className="text-center p-2 bg-green-50 rounded">
                                                                        <div className="flex items-center justify-center gap-1 mb-1">
                                                                            <DollarSign className="w-3 h-3 text-green-600" />
                                                                            <p className="text-xs font-medium text-green-900">Cost</p>
                                                                        </div>
                                                                        <p className="text-lg font-bold text-green-600">${result.cost}</p>
                                                                    </div>
                                                                    <div className="text-center p-2 bg-purple-50 rounded">
                                                                        <div className="flex items-center justify-center gap-1 mb-1">
                                                                            <Target className="w-3 h-3 text-purple-600" />
                                                                            <p className="text-xs font-medium text-purple-900">Accuracy</p>
                                                                        </div>
                                                                        <p className="text-lg font-bold text-purple-600">{result.accuracy}%</p>
                                                                    </div>
                                                                    <div className="text-center p-2 bg-orange-50 rounded">
                                                                        <div className="flex items-center justify-center gap-1 mb-1">
                                                                            <Info className="w-3 h-3 text-orange-600" />
                                                                            <p className="text-xs font-medium text-orange-900">Tokens</p>
                                                                        </div>
                                                                        <p className="text-sm font-bold text-orange-600">{result.input_tokens}</p>
                                                                        <p className="text-xs text-orange-600">/ {result.output_tokens}</p>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            {/* Extracted Data */}
                                                            <div className="bg-slate-50 p-3 flex-1 flex flex-col">
                                                                <h4 className="font-semibold text-slate-900 mb-2 flex items-center gap-2 text-sm">
                                                                    <Info className="w-4 h-4" />
                                                                    Extracted Data
                                                                </h4>
                                                                <div className="bg-white rounded border-2 border-slate-200 p-3 flex-1 overflow-auto">
                                                                    <pre className="text-xs text-slate-700 whitespace-pre-wrap font-mono max-h-64">
                                                                        {result.response_text}
                                                                    </pre>
                                                                </div>
                                                                <div className="mt-2 flex gap-2">
                                                                    <button
                                                                        onClick={() => {
                                                                            navigator.clipboard.writeText(result.response_text);
                                                                            alert('Copied!');
                                                                        }}
                                                                        className="text-xs bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded flex-1"
                                                                    >
                                                                        Copy
                                                                    </button>
                                                                    <button
                                                                        onClick={() => {
                                                                            const blob = new Blob([result.response_text], { type: 'text/plain' });
                                                                            const url = URL.createObjectURL(blob);
                                                                            const a = document.createElement('a');
                                                                            a.href = url;
                                                                            a.download = `${result.model_name.replace(/\s+/g, '_')}.txt`;
                                                                            a.click();
                                                                        }}
                                                                        className="text-xs bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded flex-1"
                                                                    >
                                                                        Download
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </>
                                                    )}

                                                    {/* Error Display */}
                                                    {!result.success && (
                                                        <div className="bg-red-50 p-4 flex-1">
                                                            <div className="flex items-start gap-2">
                                                                <AlertCircle className="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5" />
                                                                <div>
                                                                    <p className="font-semibold text-red-900 mb-1 text-sm">Error:</p>
                                                                    <p className="text-sm text-red-700">{result.error}</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    )}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </>
                        )}

                      
                    </div>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<LLMComparisonTool />, document.getElementById('root'));
    </script>
</body>
</html>
